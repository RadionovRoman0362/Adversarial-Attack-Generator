# configs/experiment_config_composite_optuna.yaml
#
# Конфигурация для запуска байесовского поиска (Optuna) композитных атак.
# Optuna будет интеллектуально исследовать пространство поиска, чтобы найти
# оптимальные по Парето решения, балансирующие между эффективностью (ASR)
# и незаметностью (L2-норма).
#
# Запуск: python scripts/run_search.py --config configs/experiment_config_composite_optuna.yaml

# --- Параметры Поиска ---
search:
  sampler: "optuna"
  # Задаем цели для многоцелевой оптимизации Optuna.
  # Optuna будет пытаться одновременно:
  # 1. Максимизировать первое возвращаемое значение из objective-функции (ASR).
  # 2. Минимизировать второе возвращаемое значение (avg_l2_norm).
  direction: ["maximize", "minimize"]

num_trials: 150         # Количество полных прогонов. Для Optuna нужно больше, чем для эволюции,
                        # чтобы построить хорошую суррогатную модель.
num_eval_samples: 1000  # На скольких примерах оценивать каждую атаку
search_space_path: "configs/search_space.yaml"
results_dir: "./results_composite_optuna" # Уникальная папка для результатов

# --- Параметры Атаки (общие для всех прогонов) ---
epsilon: 0.03137 # 8/255
steps: 40
norm: "linf"

# --- Модели для Атаки ---
models:
  - model_name: "resnet18_imagenet"
    num_classes: 10
    checkpoint_path: "./checkpoints_imagenette/model_best.pth.tar"
  - model_name: "resnet18_imagenet"
    num_classes: 10
    checkpoint_path: "./checkpoints_imagenette_pgd7/model_best.pth.tar"
  - model_name: "resnet18_imagenet"
    num_classes: 10
    checkpoint_path: "./checkpoints_imagenette_trades/model_best.pth.tar"

# --- Датасет для Атаки ---
dataset:
  name: "imagenette"
  data_dir: "./data"
  batch_size: 32
  num_workers: 4