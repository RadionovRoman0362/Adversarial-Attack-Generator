components:
  loss:
    type: choice
    values:
      - name: cross_entropy
      - name: cw
        params:
          kappa: { type: range_float, min: 0.0, max: 20.0 }
      - name: dlr
        params:
          k: { type: fixed, value: 3 }
      - name: popper

  gradient:
    type: composite
    max_depth: 3
    terminal_components:
      type: choice
      values:
        - name: standard
        - name: di
          params:
            prob: { type: fixed, value: 0.7 }
        - name: tap
          params:
            alpha: { type: range_float, min: 0.5, max: 5.0, log: true }
    decorator_components:
      type: choice
      values:
        - name: momentum
          params:
            decay_factor: { type: fixed, value: 1.0 }
        - name: smooth_adv
          params:
            num_samples: { type: range_int, min: 3, max: 15 }
            noise_stddev: { type: range_float, min: 0.05, max: 0.25 }
        - name: ti
          params:
            kernel_size: { type: choice, values: [3, 5, 7] }
        - name: ensemble
        - name: sgm

gradient_optuna:
  type: flattened_composite
  max_depth: 3
  decorator_options:
    type: choice
    values:
      - name: none
      - name: momentum
        params:
          decay_factor: { type: fixed, value: 1.0 }
      - name: smooth_adv
        params:
          num_samples: { type: range_int, min: 3, max: 15 }
          noise_stddev: { type: range_float, min: 0.05, max: 0.25 }
      - name: ti
        params:
          kernel_size: { type: choice, values: [ 3, 5, 7 ] }
      - name: ensemble
      - name: sgm
  terminal_options:
    type: choice
    values:
      - name: standard
      - name: di
        params:
          prob: { type: fixed, value: 0.7 }
      - name: tap
        params:
          alpha: { type: range_float, min: 0.5, max: 5.0, log: true }

norm_specific_components:
  type: choice
  values:
    - name: linf
      components:
        initializer: { type: choice, values: [{name: zero}, {name: random_linf}] }
        updater: { type: choice, values: [{name: sign}, {name: adam}, {name: standard}] }
        projector: { type: fixed, value: {name: linf} }
        scheduler:
          type: choice
          values:
            - name: fixed
              params:
                step_size: { type: range_float, min: 0.001, max: 0.05, log: true }
            - name: cosine
              params:
                initial_step_size: { type: range_float, min: 0.01, max: 0.2 }
            - name: multistep
              params:
                initial_step_size: { type: range_float, min: 0.01, max: 0.2 }
                milestones_rel: { type: fixed, value: [0.5, 0.75] }
                gamma: { type: fixed, value: 0.1 }
            - name: warmup_cosine
              params:
                max_step_size: { type: range_float, min: 0.01, max: 0.2 }
                warmup_steps_rel: { type: choice, values: [ 0.1, 0.2 ] }
            - name: cyclic
              params:
                base_step_size: { type: range_float, min: 0.001, max: 0.01, log: true }
                max_step_size: { type: range_float, min: 0.01, max: 0.1 }
                cycle_steps_rel: { type: choice, values: [ 0.25, 0.5 ] }
            - name: plateau
              params:
                initial_step_size: { type: range_float, min: 0.01, max: 0.2 }
                factor: { type: fixed, value: 0.5 }
                patience: { type: range_int, min: 3, max: 10 }

    - name: l2
      components:
        initializer: { type: choice, values: [{name: zero}, {name: random_l2}] }
        updater: { type: choice, values: [{name: l2}, {name: adam}, {name: standard}] }
        projector: { type: fixed, value: {name: l2} }
        scheduler:
          type: choice
          values:
            - name: fixed
              params:
                step_size: { type: range_float, min: 0.01, max: 0.5, log: true }
            - name: cosine
              params:
                initial_step_size: { type: range_float, min: 0.1, max: 1.0 }
            - name: multistep
              params:
                initial_step_size: { type: range_float, min: 0.1, max: 1.0 }
                milestones_rel: { type: fixed, value: [0.5, 0.75] }
                gamma: { type: fixed, value: 0.1 }

    - name: l1
      components:
        initializer: { type: choice, values: [{name: zero}] }
        updater: { type: choice, values: [{name: l1_median}, {name: adam}] }
        projector: { type: fixed, value: {name: l1} }
        scheduler:
          type: choice
          values:
            - name: fixed
              params:
                step_size: { type: range_float, min: 0.01, max: 0.5, log: true }
            - name: cosine
              params:
                initial_step_size: { type: range_float, min: 0.1, max: 1.0 }
            - name: multistep
              params:
                initial_step_size: { type: range_float, min: 0.1, max: 1.0 }
                milestones_rel: { type: fixed, value: [ 0.5, 0.75 ] }
                gamma: { type: fixed, value: 0.1 }